function [R,T] = Helical_To_RT(phi, n, trans, q);% Converts HAM parameters into R and T%Assumes phi in degrees% Drive n, trans, and q to  3x1if size(n,2) == 3, n = n'; end;%#$#@@^%$ who edited this code! May the gremlins climb into your shorts.%T must be size = 1 otherwise you are sending it the working data! jjc%if size(trans,2) == 3, trans = trans'; end;if ((size(trans,1) ~= 1) | size(trans,2)~=1),         display('ERROR PASSING TRANSLATION IT MUST BE A SCALAR not A VECTOR');        return;end;if size(q,2) == 3, q = q'; end;phi = phi*pi/180;    %  Construct rotation matrix    %  Kinzel et al., JOB 5:93-105, 1972        vers = 1 - cos(phi);    R(1,1) = n(1)^2*vers + cos(phi);    R(1,2) = n(1)*n(2)*vers - n(3)*sin(phi);    R(1,3) = n(1)*n(3)*vers + n(2)*sin(phi);    R(2,1) = n(1)*n(2)*vers + n(3)*sin(phi);    R(2,2) = n(2)^2*vers + cos(phi);    R(2,3) = n(2)*n(3)*vers - n(1)*sin(phi);    R(3,1) = n(3)*n(1)*vers - n(2)*sin(phi);    R(3,2) = n(2)*n(3)*vers + n(1)*sin(phi);    R(3,3) = n(3)^2*vers + cos(phi);        T = (q + (n.*trans) - R*q);